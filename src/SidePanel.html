<!-- src/SidePanel.html
<html>
  <body style="width:100%; height:100%; margin:0;">
    <div>Side Panel</div>
    <button id="start-activity">Launch Main Stage</button>

    <script src="https://anjalirawat09.github.io/meet-addons/dist/main.bundle.js"></script>
    <script>
      // Initialize the addon and attach click listener
      document.addEventListener('DOMContentLoaded', () => {
        meetAddon.setUpAddon();
      });
    </script>
  </body>
</html> -->



<!-- <html>
<head>
  <title>Meet add-on Side Panel</title>
  <script src="https://anjalirawat09.github.io/meet-addons/dist/main.bundle.js"></script>
</head>

<body style="width: 100%; height: 100%; margin: 0">
  <div>This is the add-on Side Panel. Only you can see this.</div>
  <button id="start-activity">Launch Activity in Main Stage.</button>

  <script>
    document.body.onload = () => {
      // Library name (helloWorld) is defined in the webpack config.
      // The function (setUpAddon) is defined in main.js.
      helloWorld.setUpAddon();

      //  Log when your side panel button is clicked
      const startBtn = document.getElementById("start-activity");
      if (startBtn) {
        startBtn.addEventListener("click", () => {
          console.log("Launch Activity button clicked");
        });
      }

      //Log when Google Meet's own buttons are clicked (like Leave, Present)
      const meetButtons = document.querySelectorAll(".VYBDae-Bz112c-RLmnJb");
      meetButtons.forEach(button => {
        button.addEventListener("click", () => {
          console.log("A Google Meet button (class .VfPpkd-vQzf8d) was clicked");
        });
      });
    };
  </script>
</body>
</html> -->


<!-- <html>
<head>
  <title>Meet add-on Side Panel</title>
  <script src="https://anjalirawat09.github.io/meet-addons/dist/main.bundle.js"></script>
</head>

<body style="width: 100%; height: 100%; margin: 0">
  <div>This is the add-on Side Panel. Only you can see this.</div>
  
  Buttons
  <button id="start-activity">Launch Activity in Main Stage</button>
  <button id="open-passive">Open Passive Referral</button>

  <script>
    document.body.onload = async () => {
      const { session, sidePanelClient } = await helloWorld.setUpAddon();

      // ✅ Get meeting info
      const meetingInfo = await sidePanelClient.getMeetingInfo();

      // ✅ Construct the Meet URL manually
      const meetUrl = `https://meet.google.com/${meetingInfo.meetingCode}`;

      console.log("Current Meet URL:", meetUrl, "MeetingInfo:", meetingInfo);

      // Passive Referral button
      const passiveBtn = document.getElementById("open-passive");
      if (passiveBtn) {
        passiveBtn.addEventListener("click", () => {
          const targetUrl = `https://passivereferral.com/?meetUrl=${encodeURIComponent(meetUrl)}`;
          console.log("Opening Passive Referral with:", targetUrl);
          window.open(targetUrl, "_blank");
        });
      }
    };
  </script>
</body>
</html> -->




<html>
<head>
  <title>Meet add-on Side Panel</title>
  <script src="https://anjalirawat09.github.io/meet-addons/dist/main.bundle.js"></script>
  <style>
    body {
      width: 100%;
      height: 100%;
      margin: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
    }

    button {
      margin: 8px 0;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    #submit-feedback:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
  </style>
</head>

<body>
  <div>This is the add-on Side Panel. Only you can see this.</div>
  
  <button id="submit-feedback">Submit Feedback</button>
  
  <script>
    document.body.onload = async () => {
      try {
        // ✅ Initialize the Meet SDK session and side panel client
        const { session, sidePanelClient } = await helloWorld.setUpAddon();

        // ✅ Get meeting info
        const meetingInfo = await sidePanelClient.getMeetingInfo();
        const meetUrl = `https://meet.google.com/${meetingInfo.meetingCode}`;
        console.log("Meeting Info:", meetingInfo);
        console.log("Constructed Meet URL:", meetUrl);

        // ✅ Get current user from session
        const currentUser = session?.user;  // contains email, displayName, etc.
        console.log("Current Signed-in User:", currentUser);

        // ✅ Feedback button reference
        const feedbackBtn = document.getElementById("submit-feedback");

        // Just show current user for now
        if (currentUser) {
          feedbackBtn.innerText = `Signed in as: ${currentUser.email}`;
        } else {
          feedbackBtn.disabled = true;
          feedbackBtn.innerText = "User info not available";
        }

      } catch (err) {
        console.error("Error loading Side Panel:", err);
        const feedbackBtn = document.getElementById("submit-feedback");
        feedbackBtn.disabled = true;
        feedbackBtn.innerText = "Error loading user info";
      }
    };
  </script>
</body>
</html>
